<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Angka Similarity Finder</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: Arial,sans-serif; background: linear-gradient(135deg,#667eea,#764ba2); min-height:100vh; padding:20px; }
.container { max-width:1200px; margin:0 auto; background:white; border-radius:15px; padding:30px; box-shadow:0 10px 30px rgba(0,0,0,0.2); }
h1 { text-align:center; color:#333; margin-bottom:10px; }
.subtitle { text-align:center; color:#666; font-size:14px; margin-bottom:30px; }

.input-section { background:#f8f9fa; padding:25px; border-radius:10px; border:2px solid #e9ecef; margin-bottom:25px; }
.section-title { color:#333; margin-bottom:15px; font-size:16px; font-weight:bold; }
.data-input { margin-bottom:20px; }
.data-input textarea { width:100%; height:200px; padding:15px; border:2px solid #ddd; border-radius:8px; font-size:14px; resize:vertical; font-family:monospace; }
.search-input { margin-bottom:20px; }
.search-input input { width:100%; padding:15px; border:2px solid #ddd; border-radius:8px; font-size:16px; text-align:center; }
.search-input input:focus { border-color:#667eea; outline:none; }
.button-group { display:flex; gap:15px; margin-bottom:20px; }
button { flex:1; padding:15px; border:none; border-radius:8px; font-size:16px; font-weight:bold; cursor:pointer; transition:all 0.3s; }
.btn-search { background:#4CAF50;color:white; }
.btn-clear { background:#f44336;color:white; }
button:hover { opacity:0.9; transform:translateY(-2px); }
.info { background:#e3f2fd; padding:15px; border-radius:8px; margin-bottom:20px; text-align:center; }

.results-section { background:#f8f9fa; padding:25px; border-radius:10px; border:2px solid #e9ecef; }
.result-item { margin-bottom:15px; padding:15px; background:white; border-radius:8px; border:1px solid #e0e0e0; }
.result-exact { border-left:4px solid #4CAF50; background:#e8f5e8; }
.result-similar { border-left:4px solid #FF9800; background:#fff3e0; }
.similarity-score { display:inline-block; padding:2px 8px; background:#2196F3; color:white; border-radius:10px; font-size:12px; margin-left:10px; }
.digit-match { color:#4CAF50; font-weight:bold; }
.digit-mismatch { color:#f44336; }

.stats { background:#e3f2fd; padding:15px; border-radius:8px; margin-top:20px; text-align:center; }
</style>
</head>
<body>
<div class="container">
    <h1>üîç ANGKA SIMILARITY FINDER</h1>
    <div class="subtitle">Cari angka paling mirip dari kumpulan data besar</div>
    
    <div class="input-section">
        <div class="section-title">üì• INPUT DATA ANGKA (4 digit)</div>
        
        <div class="data-input">
            <textarea id="inputData" placeholder="Masukkan data angka 4 digit (pisahkan dengan spasi/enter):&#10;2740 9348 7109 8934 0076 1267 4060&#10;4386 0267 6400 3699 6507 3203 4666&#10;0841 2496 2837 0583 0845 9265 7032">2740 9348 7109 8934 0076 1267 4060
4386 0267 6400 3699 6507 3203 4666
0841 2496 2837 0583 0845 9265 7032
1234 5678 9012 3456 7890 1357 2468
8501 8502 8503 8505 8506 8507 8508</textarea>
        </div>
        
        <div class="search-input">
            <input type="text" id="searchNumber" placeholder="Masukkan angka 4 digit yang dicari (contoh: 8504)" maxlength="4" pattern="\d{4}" title="Masukkan 4 digit angka">
        </div>
        
        <div class="button-group">
            <button class="btn-search" onclick="findSimilarNumbers()">üîç CARI ANGKA MIRIP</button>
            <button class="btn-clear" onclick="clearAll()">üóëÔ∏è CLEAR</button>
        </div>
        
        <div class="info" id="info">Masukkan data angka dan angka yang dicari, lalu klik CARI ANGKA MIRIP</div>
    </div>

    <div class="results-section" id="resultsSection" style="display:none;">
        <div class="section-title">üìä HASIL PENCARIAN</div>
        <div id="resultsContainer"></div>
        <div class="stats" id="statsInfo"></div>
    </div>

    <div class="input-section">
        <div class="section-title">‚ÑπÔ∏è CARA KERJA PROGRAM</div>
        <div class="info">
            <strong>Algoritma Similarity:</strong><br>
            1. <strong>Exact Match</strong> - Semua digit sama persis<br>
            2. <strong>3 Digit Match</strong> - 3 dari 4 digit sama<br>
            3. <strong>2 Digit Match</strong> - 2 dari 4 digit sama<br>
            4. <strong>Digit Position Score</strong> - Digit di posisi yang sama mendapat nilai lebih tinggi
        </div>
    </div>
</div>

<script>
function findSimilarNumbers() {
    const inputData = document.getElementById('inputData').value.trim();
    const searchNumber = document.getElementById('searchNumber').value.trim();
    
    if (!inputData) {
        showInfo('Masukkan data angka terlebih dahulu!', 'error');
        return;
    }
    
    if (!searchNumber || searchNumber.length !== 4 || !/^\d+$/.test(searchNumber)) {
        showInfo('Masukkan angka 4 digit yang valid!', 'error');
        return;
    }
    
    try {
        showInfo('Memproses data...', 'info');
        
        // Parse data input
        const numbers = parseInputData(inputData);
        const searchDigits = searchNumber.split('').map(Number);
        
        if (numbers.length === 0) {
            showInfo('Tidak ada angka valid yang ditemukan dalam data!', 'error');
            return;
        }
        
        // Cari angka yang mirip
        const results = findSimilarNumbersWithScores(numbers, searchDigits, searchNumber);
        
        // Tampilkan hasil
        displayResults(results, searchNumber, numbers.length);
        showInfo(`Ditemukan ${results.length} angka mirip dari ${numbers.length} total data`, 'success');
        
    } catch (error) {
        showInfo(`Error: ${error.message}`, 'error');
        console.error('Search error:', error);
    }
}

function parseInputData(inputData) {
    // Hilangkan semua karakter non-digit dan split
    const cleanedData = inputData.replace(/[^\d\s]/g, '');
    const numberStrings = cleanedData.split(/\s+/).filter(str => str.length === 4);
    
    // Convert ke array of digit arrays
    return numberStrings.map(str => ({
        original: str,
        digits: str.split('').map(Number)
    }));
}

function findSimilarNumbersWithScores(numbers, searchDigits, searchNumber) {
    const results = [];
    
    numbers.forEach(numberData => {
        const similarity = calculateSimilarity(numberData.digits, searchDigits);
        
        if (similarity.score > 0) { // Hanya tampilkan yang ada kemiripan
            results.push({
                number: numberData.original,
                digits: numberData.digits,
                similarity: similarity
            });
        }
    });
    
    // Urutkan berdasarkan similarity score (descending)
    results.sort((a, b) => b.similarity.score - a.similarity.score);
    
    return results.slice(0, 20); // Batasi maksimal 20 hasil terbaik
}

function calculateSimilarity(targetDigits, searchDigits) {
    let exactMatches = 0;
    let digitMatches = 0;
    let positionScore = 0;
    const matchedPositions = [];
    
    // Hitung exact matches dan position matches
    for (let i = 0; i < 4; i++) {
        if (targetDigits[i] === searchDigits[i]) {
            exactMatches++;
            positionScore += 10; // Bonus untuk posisi yang sama
            matchedPositions.push(i);
        }
    }
    
    // Hitung digit matches (tidak peduli posisi)
    const targetDigitCount = {};
    const searchDigitCount = {};
    
    for (let i = 0; i < 4; i++) {
        targetDigitCount[targetDigits[i]] = (targetDigitCount[targetDigits[i]] || 0) + 1;
        searchDigitCount[searchDigits[i]] = (searchDigitCount[searchDigits[i]] || 0) + 1;
    }
    
    for (const digit in searchDigitCount) {
        const minCount = Math.min(searchDigitCount[digit], targetDigitCount[digit] || 0);
        digitMatches += minCount;
    }
    
    // Calculate final score
    const score = (exactMatches * 40) + (digitMatches * 15) + positionScore;
    
    return {
        exactMatches: exactMatches,
        digitMatches: digitMatches,
        positionScore: positionScore,
        score: score,
        matchedPositions: matchedPositions
    };
}

function displayResults(results, searchNumber, totalNumbers) {
    const container = document.getElementById('resultsContainer');
    const statsInfo = document.getElementById('statsInfo');
    let html = '';
    
    if (results.length === 0) {
        html = `<div class="result-item">Tidak ditemukan angka yang mirip dengan <strong>${searchNumber}</strong></div>`;
    } else {
        results.forEach((result, index) => {
            const isExactMatch = result.similarity.exactMatches === 4;
            const resultClass = isExactMatch ? 'result-exact' : 'result-similar';
            
            html += `<div class="result-item ${resultClass}">`;
            html += `<div style="margin-bottom:8px;">`;
            html += `<strong>${result.number}</strong>`;
            html += `<span class="similarity-score">Score: ${result.similarity.score}</span>`;
            if (isExactMatch) {
                html += `<span style="color:#4CAF50; margin-left:10px;">üéØ EXACT MATCH</span>`;
            }
            html += `</div>`;
            
            // Tampilkan digit comparison
            html += `<div style="font-family:monospace; font-size:14px;">`;
            html += `Pencarian: <strong>${searchNumber}</strong><br>`;
            html += `Hasil:     `;
            for (let i = 0; i < 4; i++) {
                const digitClass = result.similarity.matchedPositions.includes(i) ? 'digit-match' : 'digit-mismatch';
                html += `<span class="${digitClass}">${result.number[i]}</span>`;
            }
            html += `<br>`;
            html += `Match: ${result.similarity.exactMatches} digit posisi sama, ${result.similarity.digitMatches} digit total sama`;
            html += `</div>`;
            html += `</div>`;
        });
    }
    
    // Stats info
    statsInfo.innerHTML = `
        <strong>üìä STATISTIK:</strong><br>
        Total data diproses: ${totalNumbers} angka<br>
        Ditemukan ${results.length} angka dengan kemiripan<br>
        Angka pencarian: <strong>${searchNumber}</strong>
    `;
    
    container.innerHTML = html;
    document.getElementById('resultsSection').style.display = 'block';
}

function showInfo(message, type) {
    const infoDiv = document.getElementById('info');
    infoDiv.textContent = message;
    infoDiv.style.background = type === 'error' ? '#ffebee' : 
                             type === 'success' ? '#e8f5e8' : '#e3f2fd';
    infoDiv.style.color = type === 'error' ? '#c62828' :
                        type === 'success' ? '#2e7d32' : '#1565c0';
}

function clearAll() {
    document.getElementById('inputData').value = '';
    document.getElementById('searchNumber').value = '';
    document.getElementById('resultsSection').style.display = 'none';
    showInfo('Masukkan data angka dan angka yang dicari, lalu klik CARI ANGKA MIRIP', 'info');
}

// Event listeners untuk Enter key
document.getElementById('searchNumber').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        findSimilarNumbers();
    }
});

// Auto-format input hanya angka
document.getElementById('searchNumber').addEventListener('input', function(e) {
    this.value = this.value.replace(/[^\d]/g, '').slice(0, 4);
});

// Update info saat data berubah
document.getElementById('inputData').addEventListener('input', function() {
    const inputData = this.value.trim();
    const numbers = inputData ? parseInputData(inputData) : [];
    document.getElementById('info').textContent = 
        `${numbers.length} angka valid terdeteksi - Masukkan angka yang dicari`;
});
</script>
</body>
</html>
